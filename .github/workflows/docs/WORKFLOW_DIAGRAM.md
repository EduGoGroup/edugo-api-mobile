# Diagrama de Workflows CI/CD

## ðŸ”„ Flujo Completo

```mermaid
graph TD
    A[Feature Branch] -->|PR| B[dev]
    B -->|PR| C[main]
    C -->|Merge| D[Production Deploy]
    
    B -->|Trigger| E[pr-to-dev.yml]
    C -->|Trigger| F[pr-to-main.yml]
    
    E --> G[Unit Tests<br/>~5s]
    E --> H[Lint<br/>~30s]
    E --> I[Coverage Check<br/>~5s]
    
    F --> J[Unit Tests<br/>~5s]
    F --> K[Integration Tests<br/>~1-2min]
    F --> L[Lint<br/>~30s]
    F --> M[Security Scan<br/>~30s]
    F --> N[Coverage Check<br/>~5s]
    
    G --> O{All Pass?}
    H --> O
    I --> O
    
    J --> P{All Pass?}
    K --> P
    L --> P
    M --> P
    N --> P
    
    O -->|Yes| Q[âœ… Ready to Merge to dev]
    O -->|No| R[âŒ Fix Issues]
    
    P -->|Yes| S[âœ… Ready to Merge to main]
    P -->|No| T[âŒ Fix Issues]
    
    S --> D
```

## ðŸ“Š ComparaciÃ³n de Workflows

### PR a Dev (Feature â†’ Dev)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PR: feature/nueva-funcionalidad â†’ dev                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Unit Tests   â”‚  â”‚    Lint      â”‚  â”‚  Coverage    â”‚     â”‚
â”‚  â”‚   ~5 sec     â”‚  â”‚   ~30 sec    â”‚  â”‚   ~5 sec     â”‚     â”‚
â”‚  â”‚   77 tests   â”‚  â”‚              â”‚  â”‚   >= 33%     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                              â”‚
â”‚  Total: ~2-3 minutos                                        â”‚
â”‚                                                              â”‚
â”‚  âœ… RÃ¡pido para desarrollo iterativo                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### PR a Main (Dev â†’ Main)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PR: dev â†’ main                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Unit Tests   â”‚  â”‚ Integration  â”‚  â”‚    Lint      â”‚     â”‚
â”‚  â”‚   ~5 sec     â”‚  â”‚   ~1-2 min   â”‚  â”‚   ~30 sec    â”‚     â”‚
â”‚  â”‚   77 tests   â”‚  â”‚   18 tests   â”‚  â”‚              â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚  â”‚  Security    â”‚  â”‚  Coverage    â”‚                        â”‚
â”‚  â”‚   ~30 sec    â”‚  â”‚   ~5 sec     â”‚                        â”‚
â”‚  â”‚              â”‚  â”‚   >= 33%     â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                              â”‚
â”‚  Total: ~3-4 minutos                                        â”‚
â”‚                                                              â”‚
â”‚  âœ… Completo para validaciÃ³n pre-producciÃ³n                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸš€ OptimizaciÃ³n de Tests de IntegraciÃ³n

### Antes (Sin Contenedores Compartidos)

```
Test 1: Create Container â†’ Run Test â†’ Destroy Container  (~20s)
Test 2: Create Container â†’ Run Test â†’ Destroy Container  (~20s)
Test 3: Create Container â†’ Run Test â†’ Destroy Container  (~20s)
...
Test 18: Create Container â†’ Run Test â†’ Destroy Container (~20s)

Total: ~7 minutos 18 segundos
```

### DespuÃ©s (Con Contenedores Compartidos)

```
Setup: Create Containers (PostgreSQL, MongoDB, RabbitMQ)  (~12s)
  â†“
Test 1: Clean Data â†’ Run Test  (~3s)
Test 2: Clean Data â†’ Run Test  (~3s)
Test 3: Clean Data â†’ Run Test  (~3s)
...
Test 18: Clean Data â†’ Run Test (~3s)
  â†“
Teardown: Destroy Containers  (~6s)

Total: ~1 minuto 21 segundos

Mejora: 81.5% mÃ¡s rÃ¡pido ðŸš€
```

## ðŸ“ˆ Timeline de EjecuciÃ³n

### Desarrollo TÃ­pico (10 PRs por dÃ­a)

```
ANTES:
PR 1: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 8 min
PR 2: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 8 min
PR 3: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 8 min
...
Total: 80 minutos de espera por dÃ­a

DESPUÃ‰S:
PR 1: â–ˆâ–ˆ 2 min (a dev)
PR 2: â–ˆâ–ˆ 2 min (a dev)
PR 3: â–ˆâ–ˆ 2 min (a dev)
...
PR 10: â–ˆâ–ˆâ–ˆâ–ˆ 4 min (a main, 1 vez por dÃ­a)
Total: 22 minutos de espera por dÃ­a

Ahorro: 58 minutos por dÃ­a = ~5 horas por semana
```

## ðŸŽ¯ Estrategia de Branches

```
main (producciÃ³n)
  â†‘
  â”‚ PR con tests completos
  â”‚ (Unit + Integration + Security)
  â”‚ ~3-4 minutos
  â”‚
dev (staging)
  â†‘
  â”‚ PR con tests rÃ¡pidos
  â”‚ (Unit + Lint)
  â”‚ ~2-3 minutos
  â”‚
feature/nueva-funcionalidad
```

## ðŸ”„ Ciclo de Vida de un Feature

```
1. Crear feature branch
   â””â”€ git checkout -b feature/nueva-funcionalidad

2. Desarrollar
   â””â”€ Commits frecuentes

3. PR a dev
   â”œâ”€ Trigger: pr-to-dev.yml
   â”œâ”€ Tests: Unit + Lint
   â”œâ”€ Tiempo: ~2-3 min
   â””â”€ Merge si pasa

4. Testing en dev
   â””â”€ QA manual/automÃ¡tico

5. PR a main
   â”œâ”€ Trigger: pr-to-main.yml
   â”œâ”€ Tests: Unit + Integration + Security
   â”œâ”€ Tiempo: ~3-4 min
   â””â”€ Merge si pasa

6. Deploy a producciÃ³n
   â””â”€ AutomÃ¡tico despuÃ©s de merge
```

## ðŸ“Š MÃ©tricas de Ã‰xito

### Velocidad

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tiempo de Feedback                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PR a dev:   â–ˆâ–ˆ 2-3 min  (70% mÃ¡s rÃ¡pido)â”‚
â”‚ PR a main:  â–ˆâ–ˆâ–ˆâ–ˆ 3-4 min (60% mÃ¡s rÃ¡pido)â”‚
â”‚ Antes:      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 8-10 min           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Confiabilidad

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cobertura de Tests                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Unit Tests:        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 77 tests    â”‚
â”‚ Integration Tests: â–ˆâ–ˆâ–ˆâ–ˆ 18 tests        â”‚
â”‚ Coverage:          â–ˆâ–ˆâ–ˆ 33.6%            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Eficiencia

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Uso de Recursos                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Contenedores creados:                   â”‚
â”‚   Antes:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 63 (21Ã—3)       â”‚
â”‚   DespuÃ©s: â–ˆ 3 (reutilizados)           â”‚
â”‚   ReducciÃ³n: 95% ðŸš€                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸŽ¨ Estados de PR

### PR a Dev

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸŸ¢ All checks passed                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… Unit Tests (77 tests)                â”‚
â”‚ âœ… Lint & Format                        â”‚
â”‚ âœ… Coverage >= 33%                      â”‚
â”‚                                          â”‚
â”‚ Ready to merge to dev                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### PR a Main

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸŸ¢ All checks passed                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… Unit Tests (77 tests)                â”‚
â”‚ âœ… Integration Tests (18 tests)         â”‚
â”‚ âœ… Lint & Format                        â”‚
â”‚ âœ… Security Scan                        â”‚
â”‚ âœ… Coverage >= 33%                      â”‚
â”‚                                          â”‚
â”‚ Ready to merge to main ðŸš€               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Ãšltima actualizaciÃ³n**: 9 de noviembre de 2025

